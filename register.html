<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Form Submission</title>
   <link rel="stylesheet" href="styles/style.css">
   <script type="module" src="script.js" defer></script>
</head>

<body>
   <form id="registerForm" class="form-container">
      <label for="first_name">Email Address</label>
      <input type="text" id="email_address" class="input-field" placeholder="john.doe@example.com" required>

      <label for="last_name">Username</label>
      <input type="text" id="user_name" class="input-field" placeholder="Michael" required>

      <label for="email">Password</label>
      <input type="password" id="user_password" class="input-field" required>

      <input type="submit" id="submit_button" class="submit-button" value="Submit">
   </form>
</body>

<script type="module">
   import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
   import { getFirestore, setDoc, doc, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
   import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
   import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

   const firebaseConfig = {
      apiKey: "AIzaSyC27V2d0DOfVG9CZgvEyqwNfAT0NHtpK60",
      authDomain: "furdopt-d1f7b.firebaseapp.com",
      projectId: "furdopt-d1f7b",
      storageBucket: "furdopt-d1f7b.appspot.com",
      messagingSenderId: "53446944629",
      appId: "1:53446944629:web:be765ca3745b2c6ff3553c",
      measurementId: "G-68ERH7FMP0"
   };
   document.getElementById("submit_button").addEventListener("click", function () {
      console.log("User has registered");
   })

   const app = initializeApp(firebaseConfig);
   const analytics = getAnalytics(app);
   const db = getFirestore(app);
   const auth = getAuth();

   document.getElementById("registerForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const userEmail = document.getElementById('email_address').value;
      const userName = document.getElementById('user_name').value;
      const userPass = document.getElementById('user_password').value;

      try {
         const docRef = doc(db, "accounts", userName);
         const userCredential = await createUserWithEmailAndPassword(auth, userEmail, userPass);

         await setDoc(docRef, {
            userEmail: userEmail,
            userName: userName,
            userPass: userPass,
         });

         console.log("Form submitted successfully:", userEmail);
         alert("You have successfully registered!");

      } catch (error) {
         console.error("Error submitting form:", error);
         alert("There was an error with your submission: " + error.message);
      }
   });


</script>

</html>